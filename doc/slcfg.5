.\" $Id$
.\" %PSC_START_COPYRIGHT%
.\" -----------------------------------------------------------------------------
.\" Copyright (c) 2009-2011, Pittsburgh Supercomputing Center (PSC).
.\"
.\" Permission to use, copy, and modify this software and its documentation
.\" without fee for personal use or non-commercial use within your organization
.\" is hereby granted, provided that the above copyright notice is preserved in
.\" all copies and that the copyright and this permission notice appear in
.\" supporting documentation.  Permission to redistribute this software to other
.\" organizations or individuals is not permitted without the written permission
.\" of the Pittsburgh Supercomputing Center.  PSC makes no representations about
.\" the suitability of this software for any purpose.  It is provided "as is"
.\" without express or implied warranty.
.\" -----------------------------------------------------------------------------
.\" %PSC_END_COPYRIGHT%
.Dd July 11, 2011
.Dt SLCFG 5
.ds volume PSC \- SLASH Administrator's Manual
.Os http://www.psc.edu/
.Sh NAME
.Nm /etc/slash/slcfg
.Nd
.Tn SLASH
file system configuration
.Sh DESCRIPTION
The
.Nm slcfg
configuration file specifies storage resources and networks for use on a
.Tn SLASH
network.
This document describes the format of this file.
.Pp
Empty lines and lines beginning with
.Sq Li #
are ignored.
.Pp
This file is consists of variables and site configurations.
.Ss Variables
Variables ascribe defaults to settings in site configuration profiles
as well as provide access to per-resource settings.
The syntax is:
.Bl -tag -offset 3n
.It Xo
.Ic set Ar var Li =
.Ar val Ns Li ;\&
.Xc
.Pp
Set the variable
.Ar var
to the given value
.Ar val .
The following variables may be set:
.Bl -tag -offset 3n -width 1n
.It Ic allow_exec
Optional executable
.Xr open 2
access list
.Pq .
This setting applies to
.Xr mount_slash 8
only.
.It Ic fs_root
For
.Xr sliod 8 ,
the file system root where backend data is stored.
This directory must be initialized with
.Xr slimmns_format 8 .
.Pp
For
.Xr mount_slash 8 ,
the file system root where file data retrieved over a
.Tn SLASH
network may be cached locally.
.It Ic journal
Set the path of the operation journal file.
May be a direct device for increased performance.
Defaults to
.Pa /var/lib/slash/op-journal .
This setting applies to
.Xr slashd 8
only.
.It Ic nets
Lustre network name(s), separated by commas.
This may alternatively be the value of
.Ev LNET_NETWORKS
in its entirety.
See
.Ev LNET_NETWORKS
in
.Xr slashd 8 ,
.Xr mount_slash 8 ,
or
.Xr sliod 8
for more information.
.It Ic port
.Tn TCP
port used to establish connections to
.Tn SLASH
peers.
.It Ic pref_ios
Preferred
.Tn I/O
system resource name.
This setting applies to
.Xr mount_slash 8
only.
.It Ic pref_mds
Default
.Tn MDS
resource name.
This setting applies to
.Xr sliod 8
and
.Xr mount_slash 8
only.
.It Ic zpool_name
The
.Tn ZFS
pool name for the backend metadata storage.
This setting applies to
.Xr slashd 8
only.
.It Ic zpool_cache
The
.Tn ZFS
pool cache file for loading the backend metadata storage.
This setting applies to
.Xr slashd 8
only.
.El
.El
.Pp
Additional configuration files may be included with
.Ic include :
.Bd -literal -offset 3n
.Ic include Dq Ar pattern
.Ed
.Pp
The
.Ar pattern
argument may be a filename or
.Xr glob 7
pattern.
.Ss Site configuration
Each site resident on a
.Tn SLASH
network requires its own section in
.Nm slcfg
and has the following format:
.Bd -unfilled -offset 3n
.Ic site @ Ns Ar site-name Li {
.D1 ...
.Li }
.Ed
.Pp
A
.Ic site
definition may itself contain variable definitions and resource
specifications.
The following variables may be set:
.Pp
.Bl -tag -offset 3n -width site_descXX -compact
.It Ic site_desc
Description of site
.It Ic site_id
Numerical identifier for site
.El
.Pp
A resource specification has the following form:
.Bd -unfilled -offset 3n
.Ic resource Ar resource-name Li {
.D1 ...
.Li }
.Ed
.Pp
Resource specifications may contain variable definition for the
following variables:
.Pp
.Bl -tag -offset 3n -width Ds -compact
.It Ic desc
Short description of this resource.
.It Ic id
Numerical identifier for resource, required to be unique for all
resources.
.It Ic nodes
One or more addresses denoting machines belonging to this resource.
.It Ic peers
List of peers separated by commas of communication resource partners in
the form
.Ar resource-name Ns Li @ Ns Ar site-name .
.It Ic type
A required resource type mostly used to distinguish behavioral
characteristics:
.Pp
.Bl -tag -width cluster_noshare_fsX -offset 3n -compact
.It Ic archival_fs
Potentially long delay storage e.g. tape archiver systems.
.It Ic cluster_noshare_fs
Non-coherent shared file systems.
.It Ic compute
Computational resources.
.It Ic mds
.Tn SLASH2
metadata servers.
.It Ic parallel_fs
Shared parallel file systems.
.It Ic standalone_fs
Independent file systems.
.El
.El
.Sh FILES
.Bl -tag -width Pa -compact
.It Pa /etc/slash/main.slcfg
default
.Tn SLASH
resource configuration
.El
.Sh EXAMPLES
The following is an example
.Nm slcfg :
.Bd -literal
set port=1000;
set net=tcp10;

site @MYSITE {
	site_desc	= "my site name";
	site_id		= 1;

	resource parfs {
		desc	= "my parallel file system";
		type	= parallel_fs;
		id	= 1;
		nodes	= 128.182.112.110,
			  128.182.112.111,
			  128.182.112.112,
			  128.182.112.113;
		peers	= supercomputer@MYSITE,
			  bigstore@MYSITE;
	}

	resource bigstore {
		desc	= "my archival storage system";
		type	= archival_fs;
		id	= 2;
		nodes	= 128.182.112.242,
			  128.182.112.240,
			  128.182.112.105,
			  128.182.112.226;
		peers	= parfs@MYSITE;
	}

	resource supercomputer {
		desc	= "my computation resource";
		type	= compute;
		id	= 3;
		nodes	= login0, login1;
		peers	= parfs@MYSITE;
	}

	resource user_pc {
		desc	= "user home network";
		type	= archival_fs;
		id	= 4;
		nodes	= 67.171.74.150;
		peers	= parfs@MYSITE;
	}

	resource test {
		desc	= "test network";
		type	= mds;
		id	= 5;
		fsroot	= /tmp/slashfs;
		nodes	= 10.32.5.82;
		peers	= parfs@MYSITE;
	}
}
.Ed
.Sh SEE ALSO
.Xr sladm 7 ,
.Xr slashd 8 ,
.Xr sliod 8
