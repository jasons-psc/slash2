.\" $Id$
.\" %PSC_START_COPYRIGHT%
.\" -----------------------------------------------------------------------------
.\" Copyright (c) 2009-2011, Pittsburgh Supercomputing Center (PSC).
.\"
.\" Permission to use, copy, and modify this software and its documentation
.\" without fee for personal use or non-commercial use within your organization
.\" is hereby granted, provided that the above copyright notice is preserved in
.\" all copies and that the copyright and this permission notice appear in
.\" supporting documentation.  Permission to redistribute this software to other
.\" organizations or individuals is not permitted without the written permission
.\" of the Pittsburgh Supercomputing Center.  PSC makes no representations about
.\" the suitability of this software for any purpose.  It is provided "as is"
.\" without express or implied warranty.
.\" -----------------------------------------------------------------------------
.\" %PSC_END_COPYRIGHT%
.Dd March 15, 2011
.Dt SLASH.CONF 5
.ds volume PSC \- SLASH Administrator's Manual
.Os http://www.psc.edu/
.Sh NAME
.Nm slash.conf
.Nd
.Tn SLASH
file system configuration
.Sh DESCRIPTION
The
.Nm
configuration file specifies storage resources and networks for use on a
.Tn SLASH
network.
This document describes the format of this file.
.Pp
Empty lines and lines beginning with
.Sq Li #
are ignored.
.Pp
This file is divided into two sections:
global configuration and per-site configuration.
.Ss Global Configuration
Configuration intended to be applied to all sites on a
.Tn SLASH
network must be specified in the first section of
.Nm
and supports the following directives:
.Bl -tag -offset 3n
.It Xo
.Ic global Ar var Li =
.Ar val Ns Li ;\&
.Xc
.Pp
Set the global variable
.Ar var
to the given value
.Ar val .
The following variables may be set:
.Bl -tag -offset 3n -width 7n
.It Ic mymds
Default
.Tn MDS
server resource name.
This setting applies to
.Xr sliod 8
and
.Xr mount_slash 8
only.
.It Ic prefios
Preferred
.Tn I/O
system.
This setting applies to
.Xr mount_slash 8
only.
.It Ic fs_root
For
.Xr sliod 8 ,
the file system root where backend data is stored.
This directory must be initialized with
.Xr slimmns_format 8 .
.Pp
For
.Xr mount_slash 8 ,
the file system root where file data retrieved over a
.Tn SLASH
network may be cached locally.
.It Ic net
Lustre network name.
See
.Ev LNET_NETWORKS
in
.Xr pflenv 7
for more information.
.It Ic port
.Tn TCP
port used to establish connections.
.El
.El
.Pp
Additional configuration files may be included at the end of the globals
section with
.Ic include :
.Bd -literal -offset 3n
.Ic include Dq Ar pattern
.Ed
.Pp
The
.Ar pattern
argument may be a filename or
.Xr glob 7
pattern.
.Ss Per-Site Configuration
Each site resident on a
.Tn SLASH
network requires its own section in the second part of
.Nm
and has the following format:
.Bd -unfilled -offset 3n
.Ic site @ Ns Ar site-name Li {
.D1 ...
.Li }
.Ed
.Pp
A
.Ic site
definition may contain variable definitions and
resource specifications.
The following variables may be set:
.Pp
.Bl -tag -offset 3n -width site_descXX -compact
.It Ic site_desc
Description of site
.It Ic site_id
Numerical identifier for site
.El
.Pp
A resource specification has the following form:
.Bd -unfilled -offset 3n
.Ic resource Ar resource-name Li {
.D1 ...
.Li }
.Ed
.Pp
Resource specifications may contain variable definition for the
following variables:
.Pp
.Bl -tag -offset 3n -width Ds -compact
.It Ic desc
Short description of this resource.
.It Ic id
Numerical identifier for resource, required to be unique for all
resources.
.It Ic ifs
Interface addresses over which to communicate with other site resources.
.It Ic mds
A Boolean value
.Ic yes
or
.Ic no
on whether this resource manages site-wide metadata, must be set on at
least one resource.
.It Ic peers
List of peers separated by commas of communication resource partners in
the form
.Ar resource-name Ns Li @ Ns Ar site-name .
.It Ic type
Type of resource, one of
.Ic archival_fs ,
.Ic compute ,
or
.Ic parallel_fs ,
required to be set for all resources.
.El
.Sh EXAMPLES
The following is an example
.Nm :
.Bd -literal
# Global network config
global port=1000;
global net=tcp10;

site @sitename {
	site_desc	= "Site Name";
	site_id		= 40;

	resource parfs {
		desc	= "parallel file system";
		type	= parallel_fs;
		id	= 0;
		ifs	= 128.182.112.110,
			  128.182.112.111,
			  128.182.112.112,
			  128.182.112.113;
		peers	= supercomputer@sitename,
			  bigstore@sitename;
	}

	resource bigstore {
		desc	= "archival storage system";
		type	= archival_fs;
		id	= 1;
		ifs	= 128.182.112.242,
			  128.182.112.240,
			  128.182.112.105,
			  128.182.112.226;
		peers	= parfs@sitename;
	}

	resource supercomputer {
		desc	= "computation resource";
		type	= compute;
		id	= 2;
		peers	= parfs@sitename;
	}

	resource user_pc {
		desc	= "user home network";
		type	= archival_fs;
		id	= 3;
		ifs	= 67.171.74.150;
		peers	= parfs@sitename;
	}

	resource test {
		desc	= "test network";
		type	= mds;
		id	= 4;
		fsroot	= /tmp/slashfs;
		ifs	= 10.32.5.82;
		peers	= parfs@sitename;
	}
}
.Ed
.Sh SEE ALSO
.Xr sladm 7 ,
.Xr slashd 8 ,
.Xr sliod 8
