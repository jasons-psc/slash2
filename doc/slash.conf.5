.\" $Id$
.\" %PSC_START_COPYRIGHT%
.\" -----------------------------------------------------------------------------
.\" Copyright (c) 2009-2011, Pittsburgh Supercomputing Center (PSC).
.\"
.\" Permission to use, copy, and modify this software and its documentation
.\" without fee for personal use or non-commercial use within your organization
.\" is hereby granted, provided that the above copyright notice is preserved in
.\" all copies and that the copyright and this permission notice appear in
.\" supporting documentation.  Permission to redistribute this software to other
.\" organizations or individuals is not permitted without the written permission
.\" of the Pittsburgh Supercomputing Center.  PSC makes no representations about
.\" the suitability of this software for any purpose.  It is provided "as is"
.\" without express or implied warranty.
.\" -----------------------------------------------------------------------------
.\" %PSC_END_COPYRIGHT%
.Dd March 16, 2011
.Dt SLASH.CONF 5
.ds volume PSC \- SLASH Administrator's Manual
.Os http://www.psc.edu/
.Sh NAME
.Nm slash.conf
.Nd
.Tn SLASH
file system configuration
.Sh DESCRIPTION
The
.Nm
configuration file specifies storage resources and networks for use on a
.Tn SLASH
network.
This document describes the format of this file.
.Pp
Empty lines and lines beginning with
.Sq Li #
are ignored.
.Pp
This file is consists of variables and site configurations.
.Ss Variables
Variables ascribe defaults to settings in site configuration profiles
as well as provide access to per-resource settings.
The syntax is:
.Bl -tag -offset 3n
.It Xo
.Ic set Ar var Li =
.Ar val Ns Li ;\&
.Xc
.Pp
Set the variable
.Ar var
to the given value
.Ar val .
The following variables may be set:
.Bl -tag -offset 3n -width 7n
.It Ic prefmds
Default
.Tn MDS
server resource name.
This setting applies to
.Xr sliod 8
and
.Xr mount_slash 8
only.
.It Ic prefios
Preferred
.Tn I/O
system.
This setting applies to
.Xr mount_slash 8
only.
.It Ic fs_root
For
.Xr sliod 8 ,
the file system root where backend data is stored.
This directory must be initialized with
.Xr slimmns_format 8 .
.Pp
For
.Xr mount_slash 8 ,
the file system root where file data retrieved over a
.Tn SLASH
network may be cached locally.
.It Ic net
Lustre network name.
See
.Ev LNET_NETWORKS
in
.Xr pflenv 7
for more information.
.It Ic port
.Tn TCP
port used to establish connections to
.Tn SLASH
peers.
.El
.El
.Pp
Additional configuration files may be included with
.Ic include :
.Bd -literal -offset 3n
.Ic include Dq Ar pattern
.Ed
.Pp
The
.Ar pattern
argument may be a filename or
.Xr glob 7
pattern.
.Ss Site Configuration
Each site resident on a
.Tn SLASH
network requires its own section in
.Nm
and has the following format:
.Bd -unfilled -offset 3n
.Ic site @ Ns Ar site-name Li {
.D1 ...
.Li }
.Ed
.Pp
A
.Ic site
definition may itself contain variable definitions and resource
specifications.
The following variables may be set:
.Pp
.Bl -tag -offset 3n -width site_descXX -compact
.It Ic site_desc
Description of site
.It Ic site_id
Numerical identifier for site
.El
.Pp
A resource specification has the following form:
.Bd -unfilled -offset 3n
.Ic resource Ar resource-name Li {
.D1 ...
.Li }
.Ed
.Pp
Resource specifications may contain variable definition for the
following variables:
.Pp
.Bl -tag -offset 3n -width Ds -compact
.It Ic desc
Short description of this resource.
.It Ic id
Numerical identifier for resource, required to be unique for all
resources.
.It Ic nodes
One or more addresses denoting machines belonging to this resource.
.It Ic peers
List of peers separated by commas of communication resource partners in
the form
.Ar resource-name Ns Li @ Ns Ar site-name .
.It Ic type
Type of resource, one of
.Ic archival_fs ,
.Ic compute ,
.Ic cluster_noshare_fs ,
.Ic mds ,
or
.Ic parallel_fs ,
required to be set for all resources.
.El
.Sh EXAMPLES
The following is an example
.Nm :
.Bd -literal
set port=1000;
set net=tcp10;

site @sitename {
	site_desc	= "Site Name";
	site_id		= 40;

	resource parfs {
		desc	= "parallel file system";
		type	= parallel_fs;
		id	= 0;
		nodes	= 128.182.112.110,
			  128.182.112.111,
			  128.182.112.112,
			  128.182.112.113;
		peers	= supercomputer@sitename,
			  bigstore@sitename;
	}

	resource bigstore {
		desc	= "archival storage system";
		type	= archival_fs;
		id	= 1;
		nodes	= 128.182.112.242,
			  128.182.112.240,
			  128.182.112.105,
			  128.182.112.226;
		peers	= parfs@sitename;
	}

	resource supercomputer {
		desc	= "computation resource";
		type	= compute;
		id	= 2;
		peers	= parfs@sitename;
	}

	resource user_pc {
		desc	= "user home network";
		type	= archival_fs;
		id	= 3;
		ifs	= 67.171.74.150;
		peers	= parfs@sitename;
	}

	resource test {
		desc	= "test network";
		type	= mds;
		id	= 4;
		fsroot	= /tmp/slashfs;
		ifs	= 10.32.5.82;
		peers	= parfs@sitename;
	}
}
.Ed
.Sh SEE ALSO
.Xr sladm 7 ,
.Xr slashd 8 ,
.Xr sliod 8
